{"version":3,"sources":["constants.js","Cards.js","Controls.js","ExpirableLocalStorage.js","App.js","reportWebVitals.js","index.js"],"names":["CARDS","CARD_NAMES","Cards","splitRegExp","RegExp","this","typeCount","typeRemove","cardTypes","map","cards","replace","split","item","trim","slice","pickedCards","index","push","_pickRandomFromArray","cardType","card","cardIndexes","sort","a","b","cardIndex","splice","oldCard","newCard","pick","array","count","shuffle","Controls","onStageChange","stage","done","className","onClick","disabled","ExpirableLocalStorage","expire","key","content","contentString","localStorage","getItem","JSON","parse","e","console","error","data","Date","setMinutes","getMinutes","setItem","stringify","expirableLocalStorage","App","useState","cardList","setCardList","time","setTime","showTime","setShowTime","setStage","initialPrepareToRemove","cardsPreparedToRemove","prepareToRemove","setDone","prepareToRemoveACard","typeIndex","get","has","delete","canRemoveCard","set","Map","size","values","rerenderList","cardsFromType","bind","type","readOnly","checked","isStage0Done","entries","allCardsPreparedToRemove","Number","useEffect","restoreFromObject","rand","newTime","unpick","Array","from","keys","onStage0Change","repick","onStage1Change","style","display","toLocaleTimeString","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e4dfb24b.chunk.js","sourcesContent":["export const ZATAN = `1. Perform one successful „Computers\" test.\n2. Kill one enemy model.\n3. Perform one successful \"Lockpick\" test.\n4. Wound two enemy models.\n5. Perform one successful \"Search\" test.\n6. Grab and hold the 1 \"item\" until the end of the game.\n7. Ensure that you have one model in the target zone.\n8. Wound the enemy leader.\n9. Perform one successful \"Presence\" test`;\n\nexport const RADIATION = `\n1. Perform three successful \"Expertise\" tests\nof any type or two successful \"Expertise\"\ntests of the same type.\n2. Kill more models than your\nenemy.\n3. Kill the enemy model that cost\nmost caps.\n4. Grab and hold the 2 \"item\" until the end\nof the game.\n5. At least one of your models should be\nin the enemy deployment zone at the\nend of the game.\n6. Ensure that you have more models in the\ntarget zone than your enemy.\n7. Select one of your models(not leader), it\nmustn't be wounded by an enemy untill the\nend of a game.\n`\n\nexport const ENERGY = `\n1. Kill the enemy leader.\n2. Your leader should be in the enemy depl\noyment zone at the end of the game.\n3. Collect twice as many caps as your\nenemy. Caps= cost of models.\n4. Kill twice as many models as your\nenemy.\n5. Ensure that you have at least one model in\nthe target zone and your enemy has none.\n6. You leader mustn't be killed by enemy\nplayer until the end of the game\n`\n\nexport const CHEM = `\n1. Perform five successful \"Expertise\" tests or\none successful \"Expertise\" test of each type.\n2. You must kill at least 80% of caps of your\nopponents forces.\n3. Grab and hold the 3 \"item\" until the end\nof the game.\n4. At the end of the game, the enemy should\nnot control the \"Item\".\n5. At least 50% of your living models,\nincluding the leader, must finish the\ngame in the enemy's deployment zone.\n6. Ensure that you have all\nyour living models in the target zone\nand your enemy has none.\n7. More than 50% of your models\nmust survive the battle.`;\n\nexport const CARDS = [\n    ZATAN, RADIATION, ENERGY, CHEM\n];\n\nexport const CARD_NAMES = ['ZATAN', 'RADIATION', 'ENERGY', 'CHEM'];","import {CARDS} from './constants';\nimport shuffle from 'shuffle-array';\n\nexport default class Cards {\n\n    constructor() {\n        const splitRegExp = new RegExp('\\\\d\\\\. ');\n        this.typeCount = [\n            5, 4, 3, 2\n        ];\n        this.typeRemove = [\n            1, 2, 2, 1\n        ];\n        this.cardTypes = CARDS.map(cards => cards.replace(/\\n/g, ' ').split(splitRegExp).map(item => item.trim()).slice(1));\n        this.pickedCards = [];\n    }\n    \n    rand() {\n        this.pickedCards = [];\n        for(const index in this.cardTypes) {\n            const cards = this.cardTypes[index];\n            this.pickedCards.push(this._pickRandomFromArray(cards, this.typeCount[index]))\n        }\n        return this.pickedCards;\n    }\n\n    pick(cardType) {\n        const card = this._pickRandomFromArray(this.cardTypes[cardType]);\n        this.pickedCards[cardType].push(card);\n        return card;\n    }\n\n    unpick(cardType, cardIndexes) {\n        cardIndexes.sort((a, b) => b - a);\n        for(const cardIndex of cardIndexes) {\n            this.cardTypes[cardType].push(this.pickedCards[cardType].splice(cardIndex, 1));\n        }\n    }\n\n    repick(cardType, cardIndex) {\n        const oldCard = this.pickedCards[cardType].splice(cardIndex, 1);\n        const newCard = this.pick(cardType);\n        this.cardTypes[cardType].push(oldCard);\n        return newCard;\n    }\n\n    _pickRandomFromArray(array, count = 1) {\n        return shuffle(array).splice(0, count);\n    }\n\n    restoreFromObject(cards) {\n        this.cardTypes = cards.cardTypes;\n        this.pickedCards = cards.pickedCards;\n    }\n}\n","import React from 'react';\n\nfunction Controls({onStageChange, stage, done}) {\n\n    return (\n        <div className=\"controls\">\n            {stage < 2 ? <button onClick={onStageChange} disabled={!done}>Далее</button> : ''}\n        </div>\n    )\n}\n\nexport default Controls;","export class ExpirableLocalStorage {\n\n  expire = 5;\n\n  get(key) {\n    let content;\n    const contentString = localStorage.getItem(key);\n    try{\n      content = JSON.parse(contentString);\n    }\n    catch (e) {\n      console.error(e);\n    }\n    if(!content || !content.expire || !content.data || new Date(content.expire) < new Date()) {\n      return false;\n    }\n    return content.data;\n  }\n\n  set(key, data) {\n    const expire = new Date();\n    expire.setMinutes(expire.getMinutes() + this.expire);\n    return localStorage.setItem(key, JSON.stringify({expire, data}));\n  }\n}\n","import './App.css';\nimport Cards from './Cards';\nimport { useEffect, useState } from 'react';\nimport { CARDS, CARD_NAMES } from './constants';\nimport Controls from './Controls';\nimport {ExpirableLocalStorage} from './ExpirableLocalStorage';\n\nconst cards = new Cards;\nconst expirableLocalStorage = new ExpirableLocalStorage;\n\nfunction App() {\n  const [cardList, setCardList] = useState([]);\n  const [time, setTime] = useState(null);\n  const [showTime, setShowTime] = useState(false);\n  const [stage, setStage] = useState(0);\n  const [cardsPreparedToRemove, prepareToRemove] = useState(initialPrepareToRemove);\n  const [done, setDone] = useState(false);\n\n  useEffect(() => {\n    const data = expirableLocalStorage.get('data');\n    if(typeof data.cards !== 'undefined' && typeof data.time !== 'undefined' && typeof data.stage !== 'undefined') {\n      const data = expirableLocalStorage.get('data');\n      cards.restoreFromObject(data.cards);\n      setTime(new Date(data.time));\n      setStage(data.stage);\n    }\n    else {\n      cards.rand();\n      const newTime = new Date();\n      setTime(newTime);\n      expirableLocalStorage.set('data', {cards, time: newTime, stage: 0})\n    }\n    rerenderList();\n  }, []);\n\n  useEffect(() => {\n    rerenderList();\n  }, [cardsPreparedToRemove]);\n\n  useEffect(() => {\n    if(stage === 0) {\n      setDone(isStage0Done());\n    }\n  }, [cardsPreparedToRemove])\n\n  useEffect(() => {\n    rerenderList();\n  }, [stage])\n\n\n  function prepareToRemoveACard(typeIndex, cardIndex) {\n    if(cardsPreparedToRemove.get(typeIndex).has(cardIndex)) {\n      cardsPreparedToRemove.get(typeIndex).delete(cardIndex);\n    }\n    else if(canRemoveCard(typeIndex)) {\n      cardsPreparedToRemove.get(typeIndex).set(cardIndex);\n    }\n    prepareToRemove(new Map(cardsPreparedToRemove));\n  }\n \n  function canRemoveCard(typeIndex) {\n      if(stage == 0) {\n        return cards.typeRemove[typeIndex] > cardsPreparedToRemove.get(typeIndex).size;\n      }\n      else if(stage === 1) {\n        for(const cardsOfType of cardsPreparedToRemove.values()) {\n            if(cardsOfType.size > 0) {\n              return false;\n            }\n            return true;\n        }\n      }\n      return false;\n  }\n\n  function rerenderList() {\n    setCardList(cards.pickedCards.map((cardsFromType, typeIndex) =>\n      <div key={typeIndex}>\n        <div>\n          {CARD_NAMES[typeIndex]}\n          {stage === 0 ? <span> Необходимо удалить {cards.typeRemove[typeIndex]}</span> : ''}\n        </div>\n        <ol>\n          {\n            cardsFromType.map((card, cardIndex) =>  \n              <li disabled={!canRemoveCard(typeIndex) && stage < 2} onClick={prepareToRemoveACard.bind(null, typeIndex, cardIndex)} key={card}>\n                {stage < 2 ? <input type=\"checkbox\" readOnly checked={cardsPreparedToRemove.get(typeIndex).has(cardIndex)}></input> : \"\"}\n                {card}\n              </li>\n            )\n          }\n        </ol>\n      </div>\n    ));\n  }\n\n  function isStage0Done() {\n      return stage > 0 || allCardsPreparedToRemove();\n  }\n\n  function allCardsPreparedToRemove() {\n      for(const [typeIndex, cardsFromType] of cardsPreparedToRemove.entries()){\n          if(cards.typeRemove[typeIndex] !== cardsFromType.size) {\n            return false;\n          }\n      }\n      return true;\n  }\n\n  function onStageChange() {\n    stage === 0 ? onStage0Change() : onStage1Change();\n  }\n\n  function onStage0Change() {\n      if(!isStage0Done()) return;\n      for(const [typeIndex, cardsFromType] of cardsPreparedToRemove.entries()){\n        cards.unpick(typeIndex, Array.from(cardsFromType.keys()));\n      }\n      setStage(1);\n      expirableLocalStorage.set('data', {cards, time, stage: 1})\n      prepareToRemove(initialPrepareToRemove());\n  }\n\n  function onStage1Change() {\n    for(const [typeIndex, cardsFromType] of cardsPreparedToRemove.entries()){\n      for(const cardIndex of cardsFromType.keys()) {\n        cards.repick(typeIndex, cardIndex);\n      }\n    }\n    setStage(2);\n    expirableLocalStorage.set('data', {cards, time, stage: 2})\n    prepareToRemove(initialPrepareToRemove());\n}\n\n\n  function initialPrepareToRemove() {\n    const cardsPreparedToRemove = new Map();\n      for(const index in CARDS) {\n          cardsPreparedToRemove.set(Number(index), new Map);\n      }\n      return cardsPreparedToRemove;\n  }\n\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        {stage === 0 ? 'Удалите ненужные карты' : ''}\n        {stage === 1 ? 'Можете заменить одну карту, на случайную того-же типа' : ''}\n        {stage === 2 ? 'Готово' : ''}\n        <button onClick={() => setShowTime(true)}>\n          Время\n        </button>\n      </header>\n      <div>\n        {cardList}\n      </div>\n      <Controls stage={stage} onStageChange={onStageChange} done={done || stage > 0} />\n      <div className=\"modal\" style={{display: showTime ? 'flex' : 'none'}} onClick={() => setShowTime(false)}>\n        <div className=\"modal-content\">\n          {time ? time.toLocaleTimeString() : 'Время не установлено'}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}